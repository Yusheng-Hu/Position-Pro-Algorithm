- name: Update Root README.md
      shell: python
      run: |
        import os
        import sys
        import datetime

        # Markers for the Python benchmark section in the root README
        start_marker = "[//]: # (PYTHON_PP_ITER_BENCHMARK_START)"
        end_marker = "[//]: # (PYTHON_PP_ITER_BENCHMARK_END)"

        # Time Calculations
        now_utc = datetime.datetime.now(datetime.timezone.utc)
        # Calculate UTC+8 (China Standard Time)
        now_beijing = now_utc + datetime.timedelta(hours=8)
        
        format_str = "%a %b %d %H:%M:%S %Y"
        time_display = f"{now_utc.strftime(format_str)} UTC / {now_beijing.strftime(format_str)} (UTC+8)"
        
        env_info = "GitHub Actions (ubuntu-latest)"

        # Load the new benchmark results
        try:
            with open("python/bench_output.md", "r", encoding="utf-8") as f:
                new_data = f.read().strip()
            
            with open("README.md", "r", encoding="utf-8") as f:
                readme_content = f.read()
        except FileNotFoundError as e:
            print(f"Error: Required file missing - {e}")
            sys.exit(1)

        if start_marker in readme_content and end_marker in readme_content:
            parts_before = readme_content.split(start_marker)[0].strip()
            parts_after = readme_content.split(end_marker)[-1].strip()
            
            # Reassemble with both timezones
            updated_content = (
                parts_before + "\n\n" + 
                start_marker + "\n\n" + 
                "### üêç Position Pure Iterator Performance (PyPy)\n\n" +
                f"#### Last Automated Run: {time_display}\n" +
                f"**Environment: {env_info}**\n\n" +
                new_data + "\n\n" + 
                end_marker + "\n\n" + 
                parts_after + "\n"
            )
            
            with open("README.md", "w", encoding="utf-8") as f:
                f.write(updated_content)
            print(f"README.md updated. Time: {time_display}")
        else:
            print("Error: Python benchmark markers not found.")
            sys.exit(1)